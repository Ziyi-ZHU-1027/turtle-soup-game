<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>海龟汤 - 情境猜谜游戏</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="app">
    <!-- 背景粒子装饰 -->
    <div class="bg-particles" id="bg-particles"></div>

    <!-- 页面1：欢迎页 -->
    <section id="screen-welcome" class="screen active">
      <div class="welcome-container">
        <div class="logo-area">
          <div class="turtle-icon">🕵️</div>
          <h1 class="game-title">海龟汤</h1>
          <p class="game-subtitle">情境猜谜游戏</p>
          <p class="game-desc">一段离奇的故事，一个未知的真相<br>用你的问题，揭开谜底</p>
        </div>
        <div class="api-key-section">
          <label for="api-key-input">DeepSeek API Key</label>
          <div class="input-wrapper">
            <input type="password" id="api-key-input" placeholder="sk-..." autocomplete="off" />
            <button class="toggle-eye" id="toggle-key" title="显示/隐藏">👁</button>
          </div>
          <small>密钥仅存储在本地浏览器中，不会上传到任何服务器</small>
        </div>
        <button class="btn-primary" id="btn-start">进入游戏</button>
      </div>
    </section>

    <!-- 页面2：选题页 -->
    <section id="screen-select" class="screen">
      <div class="select-header">
        <h2>选择谜题</h2>
        <div class="toolbar">
          <button class="btn-accent" id="btn-random">🎲 随机选题</button>
          <div class="filters">
            <select id="filter-difficulty">
              <option value="">全部难度</option>
              <option value="1">⭐ 入门</option>
              <option value="2">⭐⭐ 简单</option>
              <option value="3">⭐⭐⭐ 中等</option>
              <option value="4">⭐⭐⭐⭐ 困难</option>
              <option value="5">⭐⭐⭐⭐⭐ 地狱</option>
            </select>
            <select id="filter-tag">
              <option value="">全部分类</option>
            </select>
          </div>
        </div>
      </div>
      <div id="puzzle-grid" class="puzzle-grid"></div>
      <button class="btn-text btn-settings" id="btn-change-key">⚙ 修改 API Key</button>
    </section>

    <!-- 页面3：游戏页 -->
    <section id="screen-game" class="screen">
      <div class="game-layout">
        <!-- 顶部：汤面展示 -->
        <div class="tangmian-card" id="tangmian-display">
          <div class="tangmian-header">
            <span class="tangmian-label">🍜 汤面</span>
            <span class="tangmian-title" id="tangmian-title"></span>
          </div>
          <div class="tangmian-body" id="tangmian-body"></div>
          <button class="btn-collapse" id="btn-collapse-tangmian" title="收起/展开">▲</button>
        </div>

        <!-- 中间：聊天区域 -->
        <div class="chat-container" id="chat-messages">
          <div class="chat-welcome">
            <p>游戏开始！请根据汤面提出<strong>是非问题</strong>来推理真相。</p>
            <p class="hint">提示：问题越具体，越容易接近真相哦～</p>
          </div>
        </div>

        <!-- 底部：输入区域 -->
        <div class="chat-input-area">
          <div class="input-row">
            <input type="text" id="chat-input" placeholder="输入你的问题..." autocomplete="off" />
            <button class="btn-send" id="btn-send" title="发送">
              <span class="send-icon">➤</span>
            </button>
          </div>
          <div class="game-controls">
            <button class="btn-text" id="btn-hint">💡 提示</button>
            <span class="question-count" id="question-count">已提问 0 次</span>
            <button class="btn-text" id="btn-reveal">🔓 查看汤底</button>
            <button class="btn-text" id="btn-back">↩ 换一题</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 汤底弹窗 -->
    <div class="modal-overlay" id="modal-reveal" style="display:none">
      <div class="modal-content">
        <h3>🍲 汤底揭晓</h3>
        <div class="modal-body" id="modal-tangdi"></div>
        <div class="modal-actions">
          <button class="btn-primary" id="btn-close-modal">关闭</button>
          <button class="btn-accent" id="btn-next-puzzle">下一题</button>
        </div>
      </div>
    </div>

    <!-- 确认弹窗 -->
    <div class="modal-overlay" id="modal-confirm" style="display:none">
      <div class="modal-content modal-small">
        <h3>确定要查看汤底吗？</h3>
        <p>一旦查看就无法回头了哦！</p>
        <div class="modal-actions">
          <button class="btn-text" id="btn-confirm-cancel">继续猜</button>
          <button class="btn-accent" id="btn-confirm-reveal">查看汤底</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
